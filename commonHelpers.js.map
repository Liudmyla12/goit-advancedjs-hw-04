{"version":3,"file":"commonHelpers.js","sources":["../src/js/pixabay-api.js","../src/main.js"],"sourcesContent":["import axios from 'axios';\n\nexport async function fetchImages(query, page) {\n  const apiKey = '41067468-719d564db60da357cea4b901d';\n  const url = `https://pixabay.com/api/?key=${apiKey}&q=${encodeURIComponent(\n    query\n  )}&image_type=photo&orientation=horizontal&safesearch=true&per_page=40&page=${page}`;\n  const { data } = await axios.get(url);\n  return data;\n}\n","import { fetchImages } from './js/pixabay-api';\nimport iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\nimport SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\n\nlet currentPage = 1;\nlet currentQuery = '';\nlet isLoading = false;\nlet totalHits = 0;\nlet isSearchPerformed = false;\n\nconst container = document.getElementById('images-container');\n\nlet gallery = new SimpleLightbox('.gallery a');\n\nconst endOfListMsg = document.querySelector('.end-message');\nendOfListMsg.classList.add('none');\ndocument\n  .getElementById('search-form')\n  .addEventListener('submit', async event => {\n    event.preventDefault();\n    const query = event.target.elements.searchQuery.value.trim();\n    if (!query) {\n      iziToast.warning({\n        message: 'Please fill in the search field to find images.',\n        position: 'topRight',\n      });\n      return;\n    }\n    currentQuery = query;\n    currentPage = 1;\n\n    try {\n      isLoading = true;\n      const images = await fetchImages(currentQuery, currentPage);\n      isLoading = false;\n      isSearchPerformed = true;\n      totalHits = images.totalHits;\n\n      if (totalHits <= 0) {\n        container.innerHTML = '';\n        iziToast.error({\n          message:\n            'Sorry, there are no images matching your search query. Please try again.',\n          position: 'topRight',\n        });\n        return;\n      }\n\n      // if (images.hits.length > 0) {\n      displayImages(images.hits, true);\n      iziToast.success({\n        message: `Hooray! We found ${totalHits} images.`,\n        position: 'topRight',\n      });\n    } catch (error) {\n      isLoading = false;\n      console.error('Error during fetch operation:', error);\n      iziToast.error({\n        message: 'An error occurred while fetching images.',\n        position: 'topRight',\n      });\n    }\n\n    event.target.elements.searchQuery.value = '';\n  });\n\nfunction displayImages(images, clear) {\n  const container = document.getElementById('images-container');\n  if (clear) {\n    container.innerHTML = '';\n    gallery = new SimpleLightbox('.gallery a', {\n      captionType: 'data',\n      captionDelay: 250,\n    });\n  }\n  images.forEach(image => {\n    container.insertAdjacentHTML(\n      'beforeend',\n      `<div class=\"image-item\">\n      <a href=\"${image.largeImageURL}\"><img class=\"card\" src=\"${image.webformatURL}\" alt=\"${image.tags}\" data-title=\"${image.tags}\"/></a>\n      <div class=\"text-container\">\n        <p class=\"text\">\n          <span class=\"text-decoration\">Likes</span>\n          <span class=\"text-decor\">${image.likes}</span>\n        </p>\n        <p class=\"text\">\n          <span class=\"text-decoration\">Views</span>\n          <span class=\"text-decor\">${image.views}</span>\n        </p>\n        <p class=\"text\">\n          <span class=\"text-decoration\">Comments</span>\n          <span class=\"text-decor\">${image.comments}</span>\n        </p>\n        <p class=\"text\">\n          <span class=\"text-decoration\">Downloads</span>\n          <span class=\"text-decor\">${image.downloads}</span>\n        </p>\n      </div>\n    </div>`\n    );\n  });\n\n  gallery.refresh();\n}\n\n// ---------skroll\n\nconst observer = new IntersectionObserver(\n  (entries, observer) => {\n    if (entries[0].isIntersecting && !isLoading) {\n      if (totalHits > currentPage * 40) {\n        currentPage++;\n        fetchImages(currentQuery, currentPage).then(data => {\n          displayImages(data.hits, false);\n        });\n      } else if (\n        totalHits <= currentPage * 40 &&\n        totalHits > 0 &&\n        isSearchPerformed\n      ) {\n        endOfListMsg.classList.remove('none');\n      }\n    }\n  },\n  { rootMargin: '50px' }\n);\n\nobserver.observe(document.querySelector('.loading-observer'));\n"],"names":["fetchImages","query","page","url","data","axios","currentPage","currentQuery","isLoading","totalHits","isSearchPerformed","container","gallery","SimpleLightbox","endOfListMsg","event","iziToast","images","displayImages","error","clear","image","observer","entries"],"mappings":"owBAEO,eAAeA,EAAYC,EAAOC,EAAM,CAE7C,MAAMC,EAAM,qEAA4C,mBACtDF,CACJ,8EAAgFC,IACxE,CAAE,KAAAE,CAAI,EAAK,MAAMC,EAAM,IAAIF,CAAG,EACpC,OAAOC,CACT,CCHA,IAAIE,EAAc,EACdC,EAAe,GACfC,EAAY,GACZC,EAAY,EACZC,EAAoB,GAExB,MAAMC,EAAY,SAAS,eAAe,kBAAkB,EAE5D,IAAIC,EAAU,IAAIC,EAAe,YAAY,EAE7C,MAAMC,EAAe,SAAS,cAAc,cAAc,EAC1DA,EAAa,UAAU,IAAI,MAAM,EACjC,SACG,eAAe,aAAa,EAC5B,iBAAiB,SAAU,MAAMC,GAAS,CACzCA,EAAM,eAAc,EACpB,MAAMd,EAAQc,EAAM,OAAO,SAAS,YAAY,MAAM,OACtD,GAAI,CAACd,EAAO,CACVe,EAAS,QAAQ,CACf,QAAS,kDACT,SAAU,UAClB,CAAO,EACD,MACD,CACDT,EAAeN,EACfK,EAAc,EAEd,GAAI,CACFE,EAAY,GACZ,MAAMS,EAAS,MAAMjB,EAAYO,EAAcD,CAAW,EAK1D,GAJAE,EAAY,GACZE,EAAoB,GACpBD,EAAYQ,EAAO,UAEfR,GAAa,EAAG,CAClBE,EAAU,UAAY,GACtBK,EAAS,MAAM,CACb,QACE,2EACF,SAAU,UACpB,CAAS,EACD,MACD,CAGDE,EAAcD,EAAO,KAAM,EAAI,EAC/BD,EAAS,QAAQ,CACf,QAAS,oBAAoBP,YAC7B,SAAU,UAClB,CAAO,CACF,OAAQU,EAAP,CACAX,EAAY,GACZ,QAAQ,MAAM,gCAAiCW,CAAK,EACpDH,EAAS,MAAM,CACb,QAAS,2CACT,SAAU,UAClB,CAAO,CACF,CAEDD,EAAM,OAAO,SAAS,YAAY,MAAQ,EAC9C,CAAG,EAEH,SAASG,EAAcD,EAAQG,EAAO,CACpC,MAAMT,EAAY,SAAS,eAAe,kBAAkB,EACxDS,IACFT,EAAU,UAAY,GACtBC,EAAU,IAAIC,EAAe,aAAc,CACzC,YAAa,OACb,aAAc,GACpB,CAAK,GAEHI,EAAO,QAAQI,GAAS,CACtBV,EAAU,mBACR,YACA;AAAA,iBACWU,EAAM,yCAAyCA,EAAM,sBAAsBA,EAAM,qBAAqBA,EAAM;AAAA;AAAA;AAAA;AAAA,qCAIxFA,EAAM;AAAA;AAAA;AAAA;AAAA,qCAINA,EAAM;AAAA;AAAA;AAAA;AAAA,qCAINA,EAAM;AAAA;AAAA;AAAA;AAAA,qCAINA,EAAM;AAAA;AAAA;AAAA,WAI3C,CACA,CAAG,EAEDT,EAAQ,QAAO,CACjB,CAIA,MAAMU,EAAW,IAAI,qBACnB,CAACC,EAASD,IAAa,CACjBC,EAAQ,GAAG,gBAAkB,CAACf,IAC5BC,EAAYH,EAAc,IAC5BA,IACAN,EAAYO,EAAcD,CAAW,EAAE,KAAKF,GAAQ,CAClDc,EAAcd,EAAK,KAAM,EAAK,CACxC,CAAS,GAEDK,GAAaH,EAAc,IAC3BG,EAAY,GACZC,GAEAI,EAAa,UAAU,OAAO,MAAM,EAGzC,EACD,CAAE,WAAY,MAAQ,CACxB,EAEAQ,EAAS,QAAQ,SAAS,cAAc,mBAAmB,CAAC"}